# YM2610 Player using libvgm
add_executable(ym2610player
    src/ym2610player.cpp
    src/WAVWriter.cpp

    # Player
    libvgm/player/playerbase.cpp
    libvgm/player/vgmplayer.cpp
    libvgm/player/vgmplayer_cmdhandler.cpp
    libvgm/player/playera.cpp
    libvgm/player/s98player.cpp
    libvgm/player/droplayer.cpp
    libvgm/player/gymplayer.cpp
    libvgm/player/helper.c
    libvgm/player/dblk_compr.c

    # Emulator
    libvgm/emu/SoundEmu.c
    libvgm/emu/Resampler.c
    libvgm/emu/logging.c
    libvgm/emu/panning.c
    libvgm/emu/dac_control.c

    # Utils
    libvgm/utils/DataLoader.c
    libvgm/utils/FileLoader.c
    libvgm/utils/MemoryLoader.c
)

# Add all emulator cores
file(GLOB EMU_CORES libvgm/emu/cores/*.c)
target_sources(ym2610player PRIVATE ${EMU_CORES})

# Platform-specific utils
if(WIN32)
    target_sources(ym2610player PRIVATE
        libvgm/utils/OSMutex_Win.c
        libvgm/utils/OSSignal_Win.c
        libvgm/utils/OSThread_Win.c
        libvgm/utils/StrUtils-CPConv_Win.c
    )
else()
    target_sources(ym2610player PRIVATE
        libvgm/utils/OSMutex_POSIX.c
        libvgm/utils/OSSignal_POSIX.c
        libvgm/utils/OSThread_POSIX.c
        libvgm/utils/StrUtils-CPConv_IConv.c
    )
endif()

target_include_directories(ym2610player PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/libvgm
    ${CMAKE_CURRENT_SOURCE_DIR}/src
)

# Link libraries
if(WIN32)
    target_link_libraries(ym2610player winmm)
else()
    target_link_libraries(ym2610player pthread)
endif()

# Definitions
target_compile_definitions(ym2610player PRIVATE
    VGM_LITTLE_ENDIAN
)
